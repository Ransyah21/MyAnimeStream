<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favorit Saya - MyAnime</title> <!-- Judul lebih deskriptif -->
    <link rel="icon" href="Gambar/logo-Myanime512.png" type="image/x-icon" />
    <!-- Font Awesome (Dibutuhkan untuk ikon Hapus & mungkin header/footer) -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- === SALIN SELURUH CSS DARI index.html KE SINI === -->
    <style>
      /* Reset dan Base Styles */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      html, body { width: 100%; min-height: 100vh; scroll-behavior: smooth; }
      body { background-color: #181818; color: #fff; font-family: sans-serif; overflow-x: hidden; background-image: radial-gradient(#021027, #000000); position: relative; z-index: 1; }
      body::-webkit-scrollbar { display: none; }

      /* --- STYLE BACKGROUND PARTIKEL --- */
      #particles-background { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -2; overflow: hidden; }
      .circle-container { position: absolute; width: 5px; height: 5px; animation-iteration-count: infinite; animation-timing-function: linear; animation-name: move-frames; animation-duration: 15s; animation-delay: 0s; }
      .circle { width: 100%; height: 100%; border-radius: 50%; mix-blend-mode: screen; background-image: radial-gradient(hsl(180, 100%, 80%), hsl(180, 100%, 80%) 10%, hsla(180, 100%, 80%, 0) 56%); animation: fade-frames 2.5s infinite ease-in-out alternate, scale-frames 3.5s infinite ease-in-out alternate; }
      @keyframes fade-frames { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
      @keyframes scale-frames { 0%, 100% { transform: scale(0.6); } 50% { transform: scale(1.4); } }
      @keyframes move-frames { from { transform: translate3d(-10vw, 110vh, 0); opacity: 0; } 20%, 80% { opacity: 1; } to { transform: translate3d(110vw, -10vh, 0); opacity: 0; } }
      /* Variasi Partikel */
      .circle-container:nth-child(1) { width: 8px; height: 8px; animation-duration: 12s; animation-delay: 1s; left: 10%; }
      .circle-container:nth-child(2) { width: 5px; height: 5px; animation-duration: 19s; animation-delay: 4s; left: 50%; }
      .circle-container:nth-child(3) { width: 10px; height: 10px; animation-duration: 15s; animation-delay: 7s; left: 90%; }
      /* ... (Tambahkan variasi lain jika perlu) ... */

      /* --- STYLE UTAMA (Disalin dari index.html) --- */
      /* Base Container */
      .container { max-width: 1200px; margin: 0 auto; padding: 20px 15px; position: relative; z-index: 2; }
      .container a { text-decoration: none; color: #ccc; }
      .container a:hover { text-decoration: underline; color: #ffa200; }

      header { text-align: center; position: relative; z-index: 2; padding-top: 50px; }
      header h1 { font-size: clamp(2em, 6vw, 3em); /* Sedikit lebih kecil untuk sub-halaman */ margin: 0; }

      /* Title (jika ingin digunakan di header halaman ini) */
      .title { font-size: clamp(30px, 8vw, 45px); width: 100%; margin: 1.5rem auto; display: flex; flex-wrap: nowrap; justify-content: center; -webkit-box-reflect: below -10px linear-gradient(transparent, rgba(0, 0, 0, 0.15)); position: relative; }
      .title span { display: inline-block; font-family: "Play", sans-serif; animation: title-bounce 2.5s infinite, fire 2s ease-in-out infinite alternate; margin: 0 clamp(1px, 0.5vw, 3px); color: #ffa200; text-shadow: 0 0 10px #ff6b00; font-weight: bold; }
      @keyframes title-bounce { 0%, 60%, 100% { transform: translateY(0) scale(1); } 30% { transform: translateY(clamp(-25px, -5vw, -15px)) scale(1.1); } }
      @keyframes fire { 0% { text-shadow: 0 0 10px #ff6b00, 0 0 20px #ff6b00, 0 0 30px #ff6b00; } 100% { text-shadow: 0 0 20px #ff6b00, 0 0 40px #ff6b00, 0 0 50px #ff6b00; } }
      /* Delay animasi title */
      .title span:nth-child(1) { animation-delay: 0.3s; } .title span:nth-child(2) { animation-delay: 0.4s; } .title span:nth-child(3) { animation-delay: 0.5s; } .title span:nth-child(4) { animation-delay: 0.6s; } .title span:nth-child(5) { animation-delay: 0.7s; } .title span:nth-child(6) { animation-delay: 0.8s; } .title span:nth-child(7) { animation-delay: 0.9s; }

      /* About Link (Fixed Top) */
      .abt { background-color: rgba(24, 24, 24, 0.85); backdrop-filter: blur(8px); position: fixed; top: 0; left: 0; right: 0; padding: 10px 15px; z-index: 1001; display: flex; justify-content: flex-start; align-items: center; border-bottom: 1px solid rgba(255, 162, 0, 0.2); }
      .abt a { position: relative; text-decoration: none; color: #ccc; background-color: transparent; padding: 5px 10px; border-radius: 6px; opacity: 1; font-weight: bold; transition: color 0.3s ease, background-color 0.3s ease; }
      .abt a:hover { color: #ffa200; background-color: rgba(255, 162, 0, 0.1); }

      /* Navigation */
      nav { background-color: rgba(24, 24, 24, 0.5); padding: 10px; border-radius: 15px; opacity: 0.9; margin-top: 15px; }
      nav ul { font-weight: bold; list-style: none; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 10px 20px; }
      nav li { margin: 0; }
      nav a { color: #ffa200; text-decoration: none; padding: 8px 15px; border-radius: 10px; transition: background-color 0.3s ease, color 0.3s ease; display: inline-block; }
      nav a:hover { text-decoration: none; color: #181818; background-color: #ff8c00; }
      /* Profile Button Style */
      .profile-btn { display: flex; align-items: center; gap: 8px; text-decoration: none; color: white !important; padding: 5px 10px; border-radius: 20px; transition: background-color 0.3s ease; }
      .profile-img { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #ffa200; object-fit: cover; vertical-align: middle; box-shadow: 0 0 8px rgba(255, 162, 0, 0.5); transition: transform 0.3s ease, box-shadow 0.3s ease; }
      .profile-btn:hover { background-color: rgba(255, 162, 0, 0.2); }
      .profile-btn:hover .profile-img { transform: scale(1.1); box-shadow: 0 0 12px rgba(255, 162, 0, 0.8); }
      .profile-btn span { font-weight: bold; font-size: 0.9em; }

      /* Konten Utama */
      main { position: relative; z-index: 2; padding-top: 20px; /* Jarak dari search/nav */ }

      /* Section Title (Untuk judul "Daftar Anime Favorit") */
      main h1 { /* Target H1 di dalam main */
        color: #ffa200;
        font-size: clamp(1.8em, 5vw, 2.2em); /* Ukuran font responsif */
        margin-bottom: 30px; /* Jarak ke list favorit */
        text-align: center;
        font-weight: bold;
      }

      /* Anime List Grid (Akan digunakan untuk #favorites-container) */
      .anime-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 20px; margin-top: 20px; padding: 0 5px; }

      /* Anime Item Card (Digunakan untuk item favorit) */
      .anime-item { background-color: #282828; border-radius: 10px; box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3); text-align: center; display: flex; flex-direction: column; position: relative; transition: transform 0.2s ease, box-shadow 0.2s ease; overflow: hidden; height: 100%; /* Pastikan tinggi konsisten jika perlu */ }
      .anime-item:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4); }
      /* Link Gambar Anime */
      .anime-item > a:first-of-type { display: block; aspect-ratio: 2 / 3; overflow: hidden; }
      /* Gambar Anime */
      .anime-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease-in-out; display: block; }
      .anime-item a:hover img { transform: scale(1.07); }
      /* Konten Teks (Judul & Tombol) */
      .anime-item .anime-item-content { padding: 10px; display: flex; flex-direction: column; flex-grow: 1; /* Agar tombol bisa ke bawah */ }
      /* Link Judul Anime */
      .anime-item .anime-title-link { width: 100%; margin-bottom: 8px; flex-shrink: 0; /* Judul tidak menyusut */ }
      .anime-item .anime-title-link a { text-decoration: none; }
      .anime-item .anime-title-link span { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; font-size: 0.9em; font-weight: 600; color: #eee; line-height: 1.3; min-height: 2.6em; transition: color 0.2s ease; }
      .anime-item .anime-title-link a:hover span { color: #ffa200; }

      /* --- Tombol di Kartu Favorit --- */
      .anime-item .favorite-actions {
          margin-top: auto; /* Dorong tombol ke bawah */
          padding-top: 10px; /* Jarak dari judul */
          display: flex;
          flex-direction: column; /* Tombol tersusun vertikal */
          gap: 8px; /* Jarak antar tombol */
      }
      .anime-item .btn-streaming,
      .anime-item .btn-remove {
          display: block; /* Lebar penuh */
          padding: 8px 10px;
          border-radius: 5px;
          text-decoration: none;
          font-weight: bold;
          font-size: 13px;
          cursor: pointer;
          transition: all 0.3s ease;
          border: none; /* Hapus border default button */
          text-align: center;
      }
      /* Tombol Lihat Detail (Streaming) */
      .anime-item .btn-streaming {
          background-color: #ffa200;
          color: #181818;
      }
      .anime-item .btn-streaming:hover {
          background-color: #ff8c00;
          transform: translateY(-2px);
          color: #181818; /* Pastikan warna teks tetap */
      }
      /* Tombol Hapus */
      .anime-item .btn-remove {
          background-color: #dc3545; /* Warna merah untuk hapus */
          color: white;
      }
      .anime-item .btn-remove:hover {
          background-color: #c82333; /* Merah lebih gelap */
          transform: translateY(-2px);
      }

      /* --- NOTIFICATION --- (Sama seperti di index.html) */
      #notification { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); padding: 15px 30px; border-radius: 25px; color: white; font-weight: bold; z-index: 10000; opacity: 0; transition: opacity 0.3s ease, bottom 0.3s ease; pointer-events: none; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; }
      #notification.visible { opacity: 1; bottom: 30px; pointer-events: auto; }
      #notification.success { background: linear-gradient(45deg, #28a745, #218838); }
      #notification.error { background: linear-gradient(45deg, #dc3545, #c82333); }
      #notification.info { background: linear-gradient(45deg, #17a2b8, #138496); }

      /* --- FOOTER --- (Sama seperti di index.html) */
      .footer { background-color: #1f1f1f; color: #aaa; padding: 30px 0; font-size: 14px; position: relative; z-index: 3; margin-top: 50px; border-top: 1px solid #333; }
      .footer-section { display: flex; justify-content: space-around; align-items: flex-start; flex-wrap: wrap; max-width: 1200px; margin: 0 auto; padding: 0 15px; gap: 30px; }
      .footer-item { flex: 1; min-width: 220px; margin-bottom: 20px; padding: 0 10px; box-sizing: border-box; text-align: left; }
      .footer-item h3 { display: block; margin: 0 0 15px 0; font-size: 18px; border-bottom: 1px solid #444; padding-bottom: 8px; color: #ffa200; text-align: left; font-weight: bold; }
      .social-links-container { display: flex; flex-direction: column; gap: 12px; margin-top: 10px; align-items: flex-start; }
      .footer-item p { margin: 0 0 8px 0; display: flex; align-items: center; font-size: 14px; line-height: 1.6; color: #ccc; }
      .footer-item p a { color: #ccc; text-decoration: none; transition: color 0.3s ease; margin-left: 5px; }
      .footer-item p a:hover { color: #ffa200; text-decoration: underline; }
      .social-icon { margin-right: 10px; vertical-align: middle; width: 20px; height: auto; color: #aaa; transition: all 0.3s ease; flex-shrink: 0; }
      .trakteer-icon { width: 20px; height: auto; }
      .footer-item p a:hover .social-icon, .social-icon:hover { transform: scale(1.2) rotate(5deg); color: #ffa200; }

      /* --- MEDIA QUERIES (Disalin dari index.html) --- */
      /* Tablet dan Layar Menengah (max-width: 992px) */
      @media (max-width: 992px) {
          .container { padding: 20px 15px; }
          .anime-list { grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 15px; }
          .footer-item { min-width: 250px; }
      }
      /* Tablet Kecil & Mobile Landscape (max-width: 768px) */
      @media (max-width: 768px) {
        header h1, main h1 { font-size: 2em; } /* Sesuaikan H1 */
        nav ul { justify-content: center; gap: 8px 15px; }
        nav a { padding: 7px 12px; font-size: 0.95em; }
        .anime-list { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; }
        .anime-item .anime-title-link span { font-size: 0.85em; min-height: 2.5em; }
        .anime-item .btn-streaming, .anime-item .btn-remove { padding: 7px 8px; font-size: 12px; } /* Tombol item */
        .footer-section { flex-direction: column; align-items: center; gap: 30px; padding: 0 10px; }
        .footer-item { width: 95%; max-width: 400px; min-width: auto; margin-bottom: 0; padding: 0; text-align: center; }
        .footer-item h3 { text-align: center; margin-bottom: 15px; }
        .social-links-container { flex-direction: row; flex-wrap: wrap; justify-content: center; gap: 15px; }
        .footer-item p { justify-content: center; text-align: center; }
        .footer-item p a { margin-left: 5px; }
        .social-icon { width: 18px; }
      }
      /* Mobile Kecil (max-width: 480px) */
      @media (max-width: 480px) {
        .container { padding: 15px 10px; }
        header { padding-top: 55px; }
        header h1, main h1 { font-size: 1.8em; }
        .abt { padding: 8px 10px; }
        .abt a { font-size: 0.9em; }
        nav ul { gap: 5px 10px; }
        nav a { padding: 6px 8px; font-size: 0.9em; }
        .profile-btn { gap: 5px; padding: 4px 8px; }
        .profile-img { width: 25px; height: 25px; border-width: 1px; }
        .profile-btn span { font-size: 0.8em; }
        .anime-list { grid-template-columns: repeat(auto-fit, minmax(95px, 1fr)); gap: 12px; }
        .anime-item .anime-title-link span { font-size: 0.8em; line-height: 1.25; min-height: 2.5em; }
        .anime-item .btn-streaming, .anime-item .btn-remove { padding: 6px 7px; font-size: 11px; }
        #notification { padding: 12px 25px; font-size: 0.9em; width: 90%; }
        .footer { padding: 25px 0; }
        .footer-item h3 { font-size: 16px; }
        .footer-item p { font-size: 13px; }
      }
       /* Tambahan untuk layar sangat kecil (opsional) */
      @media (max-width: 360px) {
          .anime-list { grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); }
      }

      /* Style tambahan spesifik untuk link "Kembali ke Home" jika perlu */
      .back-to-home {
          display: inline-block; /* Agar margin bekerja */
          margin-top: 30px;
          margin-bottom: 20px; /* Jarak sebelum footer */
          color: #ffa200;
          text-decoration: underline;
          font-weight: bold;
          transition: color 0.3s ease;
      }
      .back-to-home:hover {
          color: #ff8c00;
      }

    </style>
    <!-- ================================================== -->
</head>
<body>
    <!-- Background Partikel (Sama seperti index.html) -->
    <div id="particles-background">
        <!-- ... (konten partikel tetap sama) ... -->
        <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div> <div class="circle-container"><div class="circle"></div></div>
    </div>

    <!-- Link About (Fixed Top) -->
    <div class="abt"><a href="About.html">ABOUT</a></div>

    <!-- Header (Sama seperti index.html) - Opsional tapi disarankan -->
    <header>
      <div class="container">
         <!-- Anda bisa gunakan title MyAnime atau judul halaman -->
         <!-- <h1 class="title"><span>M</span><span>y</span><span>A</span><span>n</span><span>i</span><span>m</span><span>e</span></h1> -->
        <nav>
          <ul id="menu">
            <!-- Menu akan diisi oleh JS -->
            <li><a href="index.html">HOME</a></li>
            <li><a href="#" id="google-login-btn">LOGIN</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <!-- Konten Utama Halaman Favorit -->
    <main>
        <div class="container">
            <h1>Daftar Anime Favorit</h1>
            <!-- Kontainer untuk list anime favorit -->
            <!-- Gunakan class "anime-list" agar gaya grid utama diterapkan -->
            <div id="favorites-container" class="anime-list">
                <!-- Item favorit akan di-render di sini oleh JavaScript -->
                <p style="text-align: center; color: #ccc; width: 100%; grid-column: 1 / -1; padding: 20px 0;">Memuat favorit...</p>
            </div>
            <a href="index.html" class="back-to-home">Kembali ke Beranda</a>
        </div>
    </main>

    <!-- Notifikasi (di luar main/container) -->
    <div id="notification"></div>

    <!-- Footer (Sama seperti index.html) -->
    <footer class="footer">
        <div class="footer-section">
            <div class="footer-item">
                <h3>Hak Cipta</h3>
                <p>Â© 2024 MyAnime.</p>
                <p>Dibuat dengan <i class="fas fa-heart" style="color: red;"></i> oleh Ransyah.</p>
            </div>
            <div class="footer-item">
                <h3>Ikuti & Support Kami</h3>
                <div class="social-links-container">
                    <p><a href="https://www.instagram.com/ransyah_32/" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram social-icon"></i> Instagram</a></p>
                    <p><a href="https://trakteer.id/ransyah4" target="_blank" rel="noopener noreferrer"><img src="Gambar/trakteer_logo.png" alt="Trakteer" class="trakteer-icon social-icon" style="filter: brightness(1.5);"/> Trakteer</a></p>
                    <p><a href="mailto:rizky1234kb@gmail.com"><i class="fas fa-envelope social-icon"></i> Email</a></p>
                </div>
            </div>
            <div class="footer-item">
                <h3>Hubungi Kami</h3>
                <p><a href="mailto:rizky1234kb@gmail.com">rizky1234kb@gmail.com</a></p>
            </div>
        </div>
    </footer>

    <!-- Script Eksternal (jika header/login Google dipakai) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://unpkg.com/jwt-decode/build/jwt-decode.js"></script>

    <!-- Script Internal Aplikasi -->
    <script>
        // --- Fungsi Notifikasi (Salin dari index.html jika belum digabung) ---
        function showNotification(message, type = "info", duration = 3000) {
            const notification = document.getElementById("notification");
            if (!notification) { console.warn("Notification element not found!"); alert(message); return; }
            if (notification.timerId) { clearTimeout(notification.timerId); notification.classList.remove("visible"); void notification.offsetWidth; }
            notification.className = ""; notification.classList.add("notification", type); notification.textContent = message;
             requestAnimationFrame(() => { notification.classList.add("visible"); });
            notification.timerId = setTimeout(() => { notification.classList.remove("visible"); notification.timerId = null; }, duration);
        }

        // --- Fungsi untuk Menghapus Favorit ---
        function removeFromFavorites(slug) {
            if (!slug) {
                console.error("Slug tidak valid untuk dihapus.");
                showNotification("Gagal menghapus, data tidak valid.", "error");
                return;
            }

            console.log("Attempting to remove favorite with slug:", slug);
            let favorites = [];
            try {
                favorites = JSON.parse(localStorage.getItem('favorites')) || [];
                if (!Array.isArray(favorites)) favorites = [];
            } catch (e) {
                console.error("Gagal parse favorites dari localStorage:", e);
                favorites = [];
            }

            const initialLength = favorites.length;
            // Filter anime yang mau dihapus
            favorites = favorites.filter(anime => anime.slug !== slug);
            const removed = favorites.length < initialLength;

            // Simpan lagi ke localStorage
            localStorage.setItem('favorites', JSON.stringify(favorites));

            // Update tampilan setelah hapus
            renderFavorites();

            // Tampilkan notifikasi
            if (removed) {
                showNotification("Anime berhasil dihapus dari favorit!", "info"); // Pakai tipe info untuk hapus
                console.log("Favorite removed successfully.");
            } else {
                 showNotification("Anime tidak ditemukan di favorit.", "error");
                 console.warn("Favorite with slug", slug, "not found for removal.");
            }
        }

        // --- Fungsi Render Daftar Favorit ---
        function renderFavorites() {
            const container = document.getElementById('favorites-container');
            if (!container) {
                console.error("Container #favorites-container tidak ditemukan!");
                return;
            }
            container.innerHTML = ''; // Kosongkan container

            let favorites = [];
             try {
                favorites = JSON.parse(localStorage.getItem('favorites')) || [];
                if (!Array.isArray(favorites)) favorites = [];
            } catch (e) {
                console.error("Gagal parse favorites dari localStorage:", e);
                favorites = [];
            }

            if (favorites.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #ccc; width: 100%; grid-column: 1 / -1; padding: 20px 0;">Anda belum menambahkan anime ke favorit.</p>`;
                return;
            }

            console.log(`Rendering ${favorites.length} favorite items.`);

            favorites.forEach(anime => {
                 // Validasi data minimal
                if (!anime || !anime.slug || !anime.title) {
                    console.warn("Skipping invalid favorite item:", anime);
                    return; // Lewati item jika data tidak lengkap
                }

                const imageUrl = anime.image || "Gambar/default-thumbnail.png"; // Fallback gambar
                const title = anime.title;
                const slug = anime.slug;

                // Escape karakter untuk atribut HTML dan JS (PENTING!)
                 const escapedSlug = slug.replace(/'/g, "\\'").replace(/"/g, '"');
                 const escapedTitle = title.replace(/'/g, "\\'").replace(/"/g, '"');

                const animeItem = document.createElement('div');
                // Gunakan class .anime-item agar style CSS utama diterapkan
                animeItem.className = 'anime-item';
                // Struktur HTML mirip item di index.html, tapi dengan tombol Hapus
                animeItem.innerHTML = `
                    <a href="anime.html?slug=${encodeURIComponent(slug)}" title="${escapedTitle}">
                        <img src="${imageUrl}" alt="${escapedTitle}" loading="lazy" onerror="this.src='Gambar/default-thumbnail.png'; this.onerror=null;">
                    </a>
                    <div class="anime-item-content">
                        <div class="anime-title-link">
                            <a href="anime.html?slug=${encodeURIComponent(slug)}" title="${escapedTitle}">
                                <span>${title}</span>
                            </a>
                        </div>
                        <div class="favorite-actions"> <!-- Wrapper untuk tombol -->
                            <a href="anime.html?slug=${encodeURIComponent(slug)}" class="btn-streaming">Lihat Detail</a>
                            <button class="btn-remove" onclick="removeFromFavorites('${escapedSlug}')">
                                <i class="fas fa-trash-alt"></i> Hapus <!-- Tambah ikon hapus -->
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(animeItem);
            });
        }

         // --- Fungsi Auth & Menu (Salin dari index.html jika header/footer dipakai) ---
         // Contoh placeholder (HARUS DISALIN LENGKAP DARI index.html JIKA DIPAKAI)
         async function updateMenu() {
             console.log("Updating menu (placeholder)...");
             const menu = document.getElementById('menu');
             if (!menu) return;
             // Logika untuk cek login status (localStorage/sessionStorage)
             const accessToken = localStorage.getItem("access_token");
             let userInfo = null;
             try { userInfo = JSON.parse(localStorage.getItem("user_info")); } catch(e){}
             try { if(!userInfo) userInfo = JSON.parse(sessionStorage.getItem("currentUser")); } catch(e){}

             if (accessToken && userInfo && userInfo.id) {
                 const profilePic = userInfo.picture || 'Gambar/default-avatar.png';
                 const userName = userInfo.name || 'User';
                 menu.innerHTML = `
                     <li><a href="index.html">HOME</a></li>
                     <li><a href="favorites.html" class="active">Favorites</a></li> <!-- Tandai aktif -->
                     <li>
                         <a href="#" id="logout-btn" class="profile-btn" title="Klik untuk Logout">
                             <img src="${profilePic}" alt="Profile" class="profile-img" onerror="this.src='Gambar/default-avatar.png';">
                             <span>${userName}</span>
                         </a>
                     </li>`;
                 // Attach logout handler
                 const logoutBtn = document.getElementById('logout-btn');
                 if(logoutBtn) logoutBtn.addEventListener('click', (e) => { e.preventDefault(); handleLogout(); }); // Panggil handleLogout

             } else {
                 menu.innerHTML = `
                     <li><a href="index.html">HOME</a></li>
                     <li><a href="favorites.html" class="active">Favorites</a></li>
                     <li><a href="#" id="google-login-btn">LOGIN</a></li>`;
                 // Attach login handler
                 const googleLoginBtn = document.getElementById("google-login-btn");
                 if(googleLoginBtn) googleLoginBtn.addEventListener('click', (e) => { e.preventDefault(); handleLogin(); }); // Panggil handleLogin
             }
         }

         // --- Placeholder fungsi Auth jika diperlukan ---
         function handleLogin() { console.log("handleLogin called"); /* Logika login */ }
         function handleLogout() {
             if (confirm("Anda yakin ingin keluar sekarang?")) {
                 console.log("handleLogout called");
                 localStorage.removeItem("access_token");
                 localStorage.removeItem("user_info");
                 sessionStorage.removeItem("currentUser");
                 updateMenu(); // Update menu setelah logout
                 showNotification("Anda telah berhasil logout.", "info");
             }
         }
         async function initAuth() {
             console.log("initAuth called (placeholder)");
             await updateMenu(); // Panggil updateMenu saat init
         }
         // --- Akhir Placeholder Auth ---


        // --- Panggil Render saat Halaman Dimuat ---
        document.addEventListener('DOMContentLoaded', async () => {
            console.log("Favorites page loaded. Rendering favorites...");
            // Inisialisasi Auth jika header/footer dipakai
            await initAuth();
            // Render list favorit
            renderFavorites();
        });


          // Cek apakah browser mendukung Service Worker
  if ('serviceWorker' in navigator) {
    // Daftarkan Service Worker saat halaman selesai dimuat
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/MyAnimeStream/sw.js') // <-- PENTING! Pastikan path ke sw.js benar
        .then(registration => {
          console.log('SW terdaftar:', registration);
        })
        .catch(registrationError => {
          console.log('Pendaftaran SW gagal:', registrationError);
        });
    });
  }
    </script>
</body>
</html>