<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#ffa200" />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MyAnime</title>
    <link rel="icon" href="Gambar/Logo-APL-Myanime.png" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
      /* Reset dan Base Styles */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      html, body { width: 100%; min-height: 100vh; scroll-behavior: smooth; }
      body {
        background-color: #181818; color: #fff; font-family: sans-serif;
        overflow-x: hidden; background-image: radial-gradient(#021027, #000000);
        position: relative; z-index: 1;
      }
      body::-webkit-scrollbar { display: none; }

      /* Style Partikel */
      #particles-background { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -2; overflow: hidden; }
      .circle-container { position: absolute; width: 5px; height: 5px; animation-iteration-count: infinite; animation-timing-function: linear; animation-name: move-frames; animation-duration: 15s; }
      .circle { width: 100%; height: 100%; border-radius: 50%; mix-blend-mode: screen; background-image: radial-gradient( hsl(180, 100%, 80%), hsl(180, 100%, 80%) 10%, hsla(180, 100%, 80%, 0) 56% ); animation: fade-frames 2.5s infinite ease-in-out alternate, scale-frames 3.5s infinite ease-in-out alternate; }
      @keyframes fade-frames { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
      @keyframes scale-frames { 0%, 100% { transform: scale(0.6); } 50% { transform: scale(1.4); } }
      @keyframes move-frames { from { transform: translate3d(-10vw, 110vh, 0); opacity: 0; } 20%, 80% { opacity: 1; } to { transform: translate3d(110vw, -10vh, 0); opacity: 0; } }
      .circle-container:nth-child(1) { width: 8px; height: 8px; animation-duration: 12s; animation-delay: 1s; left: 10%; }
      .circle-container:nth-child(2) { width: 5px; height: 5px; animation-duration: 19s; animation-delay: 4s; left: 50%; }
      .circle-container:nth-child(3) { width: 10px; height: 10px; animation-duration: 15s; animation-delay: 7s; left: 90%; }

      /* Style Utama */
      .container { max-width: 1200px; margin: 0 auto; padding: 20px 15px; position: relative; z-index: 2; }
      .container a { text-decoration: none; color: #ccc; }
      .container a:hover { text-decoration: underline; color: #ffa200; }
      header { transition: padding-top 0.4s ease-in-out; text-align: center; position: relative; z-index: 2; padding-top: 50px; }
      
      /* Title Animation */
      .title { transition: all 0.4s ease-in-out; font-size: clamp(30px, 8vw, 45px); width: 100%; margin: 1.5rem auto; display: flex; flex-wrap: nowrap; justify-content: center; -webkit-box-reflect: below -10px linear-gradient(transparent, rgba(0, 0, 0, 0.15)); position: relative; }

/* TAMBAHKAN BLOK BARU INI UNTUK MEMATIKAN ANIMASI DI SETIAP HURUF */
      .title span { display: inline-block; font-family: "Play", sans-serif; animation: title-bounce 2.5s infinite, fire 2s ease-in-out infinite alternate; margin: 0 clamp(1px, 0.5vw, 3px); color: #ffa200; text-shadow: 0 0 10px #ff6b00; font-weight: bold; }
      @keyframes title-bounce { 0%, 60%, 100% { transform: translateY(0) scale(1); } 30% { transform: translateY(clamp(-25px, -5vw, -15px)) scale(1.1); } }
      @keyframes fire { 0% { text-shadow: 0 0 10px #ff6b00, 0 0 20px #ff6b00, 0 0 30px #ff6b00; } 100% { text-shadow: 0 0 20px #ff6b00, 0 0 40px #ff6b00, 0 0 50px #ff6b00; } }
      .title span:nth-child(1) { animation-delay: 0.3s; } .title span:nth-child(2) { animation-delay: 0.4s; } .title span:nth-child(3) { animation-delay: 0.5s; } .title span:nth-child(4) { animation-delay: 0.6s; } .title span:nth-child(5) { animation-delay: 0.7s; } .title span:nth-child(6) { animation-delay: 0.8s; } .title span:nth-child(7) { animation-delay: 0.9s; }


      
      /* About Link (Fixed Top) */
      .abt { background-color: rgba(24, 24, 24, 0.85); backdrop-filter: blur(8px); position: fixed; top: 0; left: 0; right: 0; padding: 10px 15px; z-index: 1001; display: flex; justify-content: flex-start; align-items: center; border-bottom: 1px solid rgba(255, 162, 0, 0.2); }
      .abt a { position: relative; text-decoration: none; color: #ccc; background-color: transparent; padding: 5px 10px; border-radius: 6px; font-weight: bold; transition: color 0.3s ease, background-color 0.3s ease; }
      .abt a:hover { color: #ffa200; background-color: rgba(255, 162, 0, 0.1); }


      /* Search Container & Input */
/* GANTI BLOK CSS .search-container LAMA DENGAN INI */

/* Search Container & Input */
.search-container {
  position: block;
  top: 48px; /* Menempel 48px dari atas (beri ruang untuk bar .abt) */
  z-index: 1000;
  
  /* Style background & padding */
  backdrop-filter: blur(8px);
  padding: 15px;
  
  /* Pastikan lebar penuh dan di tengah */
  width: 100%; 
  text-align: center;
  
  /* Transisi agar mulus (opsional) */
  transition: top 0.3s ease;
}

#search-input { 
  width: 100%; 
  max-width: 600px; 
  padding: 12px 20px; 
  font-size: 16px; 
  border: 2px solid #ffa200; 
  border-radius: 25px; 
  background: rgba(40, 40, 40, 0.7); 
  color: white; 
  transition: all 0.3s ease; 
  font-weight: bold; 
}
#search-input::placeholder { color: #888; font-weight: normal; }
#search-input:focus { outline: none; box-shadow: 0 0 15px rgba(255, 162, 0, 0.5); border-color: #ff8c00; background: rgba(50, 50, 50, 0.8); }      
      main { position: relative; z-index: 2; padding-top: 20px; transition: padding-top 0.4s ease-in-out;}
      section.nama h2 { color: #ffa200; font-size: clamp(1.5em, 5vw, 2em); margin-bottom: 20px; text-align: center; font-weight: bold; }
      
      .anime-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 20px; margin-top: 20px; padding: 0 5px; }
      .anime-list.list-layout { display: flex; flex-direction: column; align-items: center; gap: 25px; grid-template-columns: none; }
      .anime-item { background-color: #282828; border-radius: 10px; box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3); text-align: center; display: flex; flex-direction: column; position: relative; transition: transform 0.2s ease, box-shadow 0.2s ease; overflow: hidden; width: 100%; max-width: 180px; justify-self: center; }
      .anime-list.list-layout .anime-item { flex-direction: row; max-width: 800px; text-align: left; padding: 15px; gap: 15px; justify-self: initial; }
      .anime-item:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4); }
      .anime-item .anime-image-link { display: block; overflow: hidden; width: 100%; aspect-ratio: 2 / 3; }
      .anime-list.list-layout .anime-item .anime-image-link { width: 150px; height: auto; flex-shrink: 0; border-radius: 6px; }
      .anime-item img { display: block; width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease-in-out; }
      .anime-item .anime-image-link:hover img { transform: scale(1.07); }
      .anime-item .anime-details { display: flex; flex-direction: column; padding: 10px; gap: 8px; flex-grow: 1; }
      .anime-list.list-layout .anime-item .anime-details { padding: 0; gap: 10px; flex-grow: 1; justify-content: flex-start; min-width: 0; }
      .anime-item .anime-title { font-size: 0.9em; font-weight: 600; color: #eee; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; min-height: 2.6em; margin: 0; }
      .anime-item .anime-title a { color: inherit; text-decoration: none; transition: color 0.2s ease; }
      .anime-item .anime-title a:hover { color: #ffa200; }
      .anime-list.list-layout .anime-item .anime-title { font-size: 1.2em; font-weight: bold; color: #ffa200; margin-bottom: 5px; display: block; -webkit-line-clamp: initial; min-height: auto; }
      .anime-list.list-layout .anime-item .anime-title a:hover { text-decoration: underline; }
      .anime-item .anime-description { display: none; }
      .anime-list.list-layout .anime-item .anime-description { display: -webkit-box; font-size: 0.9em; color: #ccc; line-height: 1.5; -webkit-line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; margin-bottom: auto; }
      
      @media (max-width: 480px) { /* Target untuk layar HP (lebar 480px ke bawah) */
        .anime-list {
          /* Paksa grid untuk selalu menjadi 3 kolom yang sama lebarnya */
          grid-template-columns: repeat(3, 1fr);
          gap: 10px; /* Kurangi jarak antar item agar lebih pas */
        }

        .anime-item .anime-title {
          font-size: 0.8em; /* Sedikit kecilkan font judul agar tidak terpotong */
          line-height: 1.2;
          min-height: 2.4em; /* Sesuaikan tinggi minimum agar pas 2 baris */
        }
      }

      .notice { margin: 30px auto; padding: 15px 20px; background-color: rgba(40, 40, 40, 0.8); border-radius: 8px; max-width: 600px; text-align: center; color: #ccc; position: relative; z-index: 2; border-left: 4px solid #ffa200; }
      .notice p { margin-bottom: 10px; line-height: 1.5; font-size: 0.95em; }
      .notice p:last-child { margin-bottom: 0; }

      /* --- STYLE UNTUK POPUP GENRE --- */

.genre-popup {
  display: none; /* Sembunyi secara default */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7); /* Overlay gelap */
  backdrop-filter: blur(5px);
  z-index: 2000; /* Paling atas */
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.genre-popup.visible {
  display: flex; /* Tampilkan saat class 'visible' ditambahkan */
}

.genre-popup-content {
  background-color: #282828;
  padding: 25px;
  border-radius: 15px;
  width: 100%;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  border: 1px solid rgba(255, 162, 0, 0.2);
  text-align: center;
  position: relative;
}

.genre-popup-content h3 {
  color: #ffa200;
  margin-bottom: 20px;
  font-size: 1.5em;
}

/* Gunakan kembali style .genre-list dan .genre-btn yang sudah ada */
.genre-popup .genre-list {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}

/* Kita tidak perlu lagi style untuk .genre-filter, .genre-header, dll. Bisa dihapus */
      .genre-list-container { max-height: 500px; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease; }
      .genre-list-container.collapsed { max-height: 0; opacity: 0; margin-top: 0; padding-top: 0; padding-bottom: 0; border-top: none; }
      .genre-list-container:not(.collapsed) { margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255, 162, 0, 0.1); }
      .genre-list { display: flex; flex-wrap: wrap; gap: 10px; padding: 0 10px 5px; justify-content: center; }
      .genre-btn { padding: 8px 18px; background: #3a3a3a; border: none; border-radius: 25px; color: white; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); font-weight: bold; font-size: 0.9em; }
      .genre-btn:hover { background: #ffa200; color: #181818; transform: translateY(-2px); box-shadow: 0 4px 15px rgba(255, 162, 0, 0.3); }
      .genre-btn.selected { background: #ffa200; color: #181818; transform: translateY(-3px); box-shadow: 0 5px 20px rgba(255, 162, 0, 0.4); }

      .pagination-container { margin: 30px 0; display: flex; justify-content: center; position: relative; z-index: 2; }
      .pagination-controls { display: flex; gap: 15px; align-items: center; background-color: rgba(40, 40, 40, 0.8); padding: 10px 20px; border-radius: 20px; }
      .pagination-btn { padding: 8px 16px; background: #ffa200; border: none; border-radius: 4px; color: #181818; cursor: pointer; transition: all 0.3s; font-weight: bold; }
      .pagination-btn:hover:not(:disabled) { background: #ff8c00; transform: translateY(-2px); }
      .pagination-btn:disabled { background: #555; cursor: not-allowed; opacity: 0.6; }
      .page-info { color: #fff; font-size: 1em; font-weight: bold; }

      #notification { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); padding: 15px 30px; border-radius: 25px; color: white; font-weight: bold; z-index: 10000; opacity: 0; transition: opacity 0.3s ease, bottom 0.3s ease; pointer-events: none; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; }
      #notification.visible { opacity: 1; bottom: 30px; }
      #notification.success { background: linear-gradient(45deg, #28a745, #218838); }
      #notification.error { background: linear-gradient(45deg, #dc3545, #c82333); }
      #notification.info { background: linear-gradient(45deg, #17a2b8, #138496); }

      .footer { background-color: #1f1f1f; color: #aaa; padding: 30px 0; font-size: 14px; position: relative; z-index: 3; margin-top: 50px; border-top: 1px solid #333; }
      .footer-section { display: flex; justify-content: space-around; align-items: flex-start; flex-wrap: wrap; max-width: 1200px; margin: 0 auto; padding: 0 15px; gap: 30px; }
      .footer-item { flex: 1; min-width: 220px; margin-bottom: 20px; padding: 0 10px; text-align: left; }
      .footer-item h3 { margin: 0 0 15px 0; font-size: 18px; border-bottom: 1px solid #444; padding-bottom: 8px; color: #ffa200; font-weight: bold; }
      .footer-item p { margin: 0 0 8px 0; display: flex; align-items: center; font-size: 14px; line-height: 1.6; color: #ccc; }
      .footer-item p a { color: #ccc; transition: color 0.3s ease; margin-left: 5px; }
      .footer-item p a:hover { color: #ffa200; }
      .social-icon { margin-right: 10px; width: 20px; color: #aaa; transition: all 0.3s ease; }
      .footer-item p a:hover .social-icon { transform: scale(1.2) rotate(5deg); color: #ffa200; }

      #myDynamicSplash { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #181818; display: flex; align-items: center; justify-content: center; text-align: center; z-index: 99999; transition: opacity 0.5s ease; }
      .splash-content { position: relative; }
      .splash-title { font-size: clamp(30px, 8vw, 45px); margin-bottom: 2rem; display: flex; justify-content: center; }
      .splash-title span { display: inline-flex; font-family: "Play", sans-serif; animation: title-bounce 2.5s infinite, fire 2s ease-in-out infinite alternate; margin: 0 clamp(1px, 0.5vw, 3px); color: #ffa200; text-shadow: 0 0 10px #ff6b00; font-weight: bold; }
      .sk-cube-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 40px; height: 40px; margin: 20px auto; }
      .sk-cube { width: 10px; height: 10px; background-color: #ffa200; animation: sk-cubeGridScaleDelay 1.3s infinite ease-in-out; }
      @keyframes sk-cubeGridScaleDelay { 0%, 70%, 100% { transform: scale3D(1, 1, 1); } 35% { transform: scale3D(0, 0, 1); } }
      .network-status { position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%); color: #ff5555; font-size: 1.1em; text-align: center; opacity: 0; transition: opacity 0.3s ease; width: 80%; max-width: 300px; font-weight: bold; }
      .network-status.show { opacity: 1; }

      @media (max-width: 768px) {
        .footer-section { flex-direction: column; align-items: center; text-align: center; }
        .footer-item { width: 95%; text-align: center; }
        .footer-item h3, .footer-item p { justify-content: center; text-align: center; }
      }

      /* --- STYLE UNTUK TOMBOL SCROLL TO TOP --- */

#scrollToTopBtn {
  position: fixed; /* Membuatnya melayang di atas segalanya */
  bottom: 20px;
  right: 20px;
  z-index: 1050; /* Pastikan di atas semua elemen lain */
  
  /* Bentuk & Ukuran */
  width: 50px;
  height: 50px;
  border-radius: 50%; /* Membuatnya bulat sempurna */
  
  /* Tampilan */
  background-color: #ffa200;
  color: #181818;
  border: none;
  font-size: 24px;
  font-weight: bold;
  cursor: pointer;
  
  /* Posisi Ikon di Tengah */
  display: flex;
  align-items: center;
  justify-content: center;
  
  /* Efek & Visibilitas Awal */
  opacity: 0; /* Sembunyi secara default */
  transform: translateY(100px); /* Posisi awal di luar layar */
  pointer-events: none; /* Tidak bisa diklik saat sembunyi */
  transition: opacity 0.3s ease, transform 0.3s ease;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

#scrollToTopBtn.visible {
  opacity: 1; /* Tampilkan */
  transform: translateY(0); /* Pindahkan ke posisi normal */
  pointer-events: auto; /* Bisa diklik */
}

#scrollToTopBtn:hover {
  background-color: #ff8c00;
  transform: scale(1.1); /* Sedikit membesar saat disentuh mouse */
}

    </style>
  </head>
  <body>
    <!-- Background Partikel (Tidak perlu diubah) -->
    <div id="particles-background">
      <!-- 100 div.circle-container -->
      <div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div><div class="circle-container"><div class="circle"></div></div>
    </div>

    <!-- Link About (Fixed Top) -->
    <div class="abt"><a href="About.html">About</a>
      <a href="index.html">Beranda</a>
      <a href="#" id="genre-popup-btn">Genre</a></div>
    

    <header>
      <div class="container">
        <h1 class="title">
          <span>M</span><span>y</span><span>A</span><span>n</span><span>i</span><span>m</span><span>e</span>
        </h1>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="Cari judul anime..." name="keyword" />
        </div>
      </div>
    </header>

    <div id="genre-popup-container" class="genre-popup">
      <div class="genre-popup-content">
        <h3>Pilih Genre</h3>
        <div class="genre-list">
          <!-- Daftar genre akan diisi oleh JavaScript -->
        </div>
      </div>
    </div>

    <main>
      <div class="container">
        <div class="notice">
          <p>Selamat datang! Situs ini masih dalam tahap pengembangan.</p>
          <p>Temukan rekomendasi anime pilihan di sini. Belum semua genre tersedia, tapi kami terus menambahkannya. Ajak temanmu!</p>
        </div>

        <div id="content">
          <section class="nama">
            <h2>Anime Terbaru</h2>
            <div id="anime-list-container" class="anime-list">
              <!-- List anime akan diisi oleh JS -->
            </div>
          </section>
        </div>
      </div>
    </main>

    <div id="notification"></div>

    <footer class="footer">
      <div class="footer-section">
        <div class="footer-item">
          <h3>Hak Cipta</h3>
          <p>© 2024 MyAnime.</p>
          <p>Dikelola dan dikembangkan oleh Ransyah</p>
        </div>
        <div class="footer-item">
          <h3>Ikuti & Support Kami</h3>
          <p><a href="https://www.instagram.com/ransyah_32/" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram social-icon"></i> Instagram</a></p>
          <p><a href="mailto:rizky1234kb@gmail.com"><i class="fas fa-envelope social-icon"></i> Email</a></p>
        </div>
        <div class="footer-item">
          <h3>Hubungi Kami</h3>
          <p><a href="mailto:rizky1234kb@gmail.com">rizky1234kb@gmail.com</a></p>
        </div>
      </div>
    </footer>

    <button id="scrollToTopBtn" title="Kembali ke atas">▲</button>

    <script>
// --- BAGIAN 1: DEFINISI VARIABEL & FUNGSI ---

// Variabel Global
let currentPage = 1;
let itemsPerPage = 21;
let totalPages = 1;
let allAnimeData = [];
let filteredData = [];
let searchTimer;
let selectedGenre = "All";

const searchInput = document.getElementById("search-input");
const animeListContainer = document.getElementById("anime-list-container");

// Fungsi Splash Screen
function createSplashScreen() {
  const isHomePage = window.location.pathname.endsWith("index.html") || window.location.pathname === "/" || window.location.pathname.endsWith("/MyAnime/") || window.location.pathname.endsWith("/MyAnime");
  if (!sessionStorage.getItem("splashShown") && isHomePage) {
    const splashScreen = document.createElement("div");
    splashScreen.id = "myDynamicSplash";
    splashScreen.innerHTML = `<div class="splash-content"><div class="splash-title">${Array.from("MyAnime").map((l, i) => `<span style="animation-delay: ${0.3 + i * 0.1}s">${l}</span>`).join('')}</div><div class="sk-cube-grid">${Array(9).fill('<div class="sk-cube"></div>').join('')}</div><div class="network-status"></div></div>`;
    document.body.prepend(splashScreen);
    sessionStorage.setItem("splashShown", "true");
    return { splashScreen, errorMessage: splashScreen.querySelector('.network-status') };
  }
  return null;
}
function initSplashScreen() {
  const splashData = createSplashScreen();
  if (!splashData) return () => {};
  const { splashScreen, errorMessage } = splashData;
  let isLoaded = false;
  const showNetworkError = (message) => { errorMessage.textContent = message; errorMessage.classList.add("show"); };
  if (!navigator.onLine) showNetworkError("Koneksi internet offline");
  window.addEventListener("offline", () => showNetworkError("Koneksi internet offline"));
  window.addEventListener("online", () => errorMessage.classList.remove("show"));
  const hideSplash = () => {
    if (isLoaded || !splashScreen) return;
    isLoaded = true;
    splashScreen.style.opacity = "0";
    splashScreen.addEventListener("transitionend", () => splashScreen.remove());
  };
  setTimeout(() => { if (!isLoaded) showNetworkError("Memuat data agak lama..."); }, 7000);
  return hideSplash;
}

// Fungsi State Management
function saveState() {
  const state = {
    scrollPosition: window.scrollY,
    searchTerm: searchInput.value,
    selectedGenre: selectedGenre,
    currentPage: currentPage
  };
  sessionStorage.setItem('pageState', JSON.stringify(state));
  console.log("📝 State saved:", state);
}
function restoreState() {
  const savedState = sessionStorage.getItem('pageState');
  if (savedState) {
    const state = JSON.parse(savedState);
    console.log("🔄 Restoring state:", state);
    searchInput.value = state.searchTerm || "";
    selectedGenre = state.selectedGenre || "All";
    currentPage = state.currentPage || 1;
    return state.scrollPosition || 0;
  }
  return 0;
}

// Fungsi Data Loading & Rendering
async function loadAnimeData() {
  try {
    const response = await fetch("./anime-data.json", { cache: "no-store" });
    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
    const data = await response.json();
    return (data.data || data).filter(anime => anime && anime.title && anime.slug);
  } catch (error) {
    console.error("❌ Error kritikal saat memuat data anime:", error);
    return [];
  }
}
function renderAnimeItems(data) {
  if (!animeListContainer) return;
  if (data.length === 0) {
    const info = selectedGenre !== "All" ? `untuk genre "${selectedGenre}"` : searchInput.value ? `dengan kata kunci "${searchInput.value}"` : "";
    animeListContainer.innerHTML = `<p style="text-align: center; color: #ccc; width: 100%; grid-column: 1 / -1; padding: 20px 0;">Tidak ada anime ditemukan ${info}.</p>`;
    return;
  }
  animeListContainer.innerHTML = data.map(anime => `
    <div class="anime-item">
      <a href="anime.html?slug=${encodeURIComponent(anime.slug)}" class="anime-image-link" title="${anime.title}">
        <img src="${anime.image || 'Gambar/default-thumbnail.png'}" alt="${anime.title}" loading="lazy" onerror="this.src='Gambar/default-thumbnail.png';">
      </a>
      <div class="anime-details">
        <h3 class="anime-title"><a href="anime.html?slug=${encodeURIComponent(anime.slug)}" title="${anime.title}">${anime.title}</a></h3>
        <p class="anime-description">${anime.desc || 'Deskripsi tidak tersedia.'}</p>
      </div>
    </div>`).join("");
}
function renderPagination() {
  let paginationContainer = document.querySelector("#pagination-top");
  if (!paginationContainer) {
    paginationContainer = document.createElement("div");
    paginationContainer.className = "pagination-container";
    paginationContainer.id = "pagination-top";
    const sectionTitle = document.querySelector("section.nama");
    if (sectionTitle) {
      sectionTitle.parentNode.insertBefore(paginationContainer, sectionTitle);
    }
  }
  if (totalPages <= 1) {
    paginationContainer.innerHTML = "";
    return;
  }
  paginationContainer.innerHTML = `
    <div class="pagination-controls">
        <button class="pagination-btn" id="prev-btn" ${currentPage === 1 ? "disabled" : ""}>Previous</button>
        <span class="page-info">Hal ${currentPage} / ${totalPages}</span>
        <button class="pagination-btn" id="next-btn" ${currentPage === totalPages ? "disabled" : ""}>Next</button>
    </div>`;
  document.getElementById("prev-btn")?.addEventListener("click", () => { if (currentPage > 1) { currentPage--; updateDisplay(); } });
  document.getElementById("next-btn")?.addEventListener("click", () => { if (currentPage < totalPages) { currentPage++; updateDisplay(); } });
}
function updateDisplay() {
  const start = (currentPage - 1) * itemsPerPage;
  const end = start + itemsPerPage;
  const itemsToDisplay = filteredData.slice(start, end);
  const sectionTitle = document.querySelector("section.nama h2");
  if (sectionTitle) {
    let titleText = "Semua Anime";
    if (selectedGenre !== "All") titleText = `Genre: ${selectedGenre}`;
    if (searchInput.value.trim()) titleText = `Hasil Pencarian: "${searchInput.value.trim()}"`;
    sectionTitle.textContent = `${titleText} (${filteredData.length} hasil)`;
  }
  renderAnimeItems(itemsToDisplay);
  renderPagination();
}

// Fungsi Search & Filter
function filterAndDisplay(searchValue = "", genre = "All") {
  animeListContainer.classList.toggle("list-layout", genre !== "All" || searchValue.trim() !== "");
  let temp_data = allAnimeData.filter(anime => 
    (genre === "All" || anime.info?.genres?.some(g => g.toLowerCase() === genre.toLowerCase())) &&
    (anime.title?.toLowerCase().includes(searchValue))
  );
  filteredData = temp_data;
  totalPages = Math.ceil(filteredData.length / itemsPerPage) || 1;
  if (!sessionStorage.getItem('pageState')) currentPage = 1;
  updateDisplay();
}
function renderGenreFilters() {
  // Targetnya sekarang adalah .genre-list di dalam popup
  const genreContainer = document.querySelector("#genre-popup-container .genre-list");
  if (!genreContainer) return;

  const allGenres = new Set(allAnimeData.flatMap(anime => anime.info?.genres || []).filter(Boolean));
  const sortedGenres = Array.from(allGenres).sort((a, b) => a.localeCompare(b));

  genreContainer.innerHTML = "";
  
  const createGenreButton = (genre) => {
    const button = document.createElement("button");
    button.className = "genre-btn";
    button.textContent = genre;
    button.dataset.genre = genre;
    if (selectedGenre === genre) button.classList.add("selected");
    
    button.addEventListener("click", () => {
      // 1. Logika filter yang sudah ada
      sessionStorage.removeItem('pageState');
      selectedGenre = genre;
      searchInput.value = "";
      filterAndDisplay("", genre);
      document.querySelectorAll("#genre-popup-container .genre-btn").forEach(btn => btn.classList.remove("selected"));
      button.classList.add("selected");
      
      // 2. Tutup Popup
      document.getElementById('genre-popup-container').classList.remove('visible');

      // 3. Scroll ke bagian hasil
      const targetElement = document.querySelector("section.nama h2");
      if (targetElement) {
        setTimeout(() => { // Beri sedikit delay agar konten sempat render
          targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
      }
    });
    return button;
  };

  // Tambahkan tombol 'All' dan semua genre lainnya
  genreContainer.appendChild(createGenreButton("All"));
  sortedGenres.forEach(genre => genreContainer.appendChild(createGenreButton(genre)));
}
// Fungsi Efek UI

function initScrollToTopButton() {
  const scrollToTopBtn = document.getElementById('scrollToTopBtn');
  const targetElement = document.getElementById('pagination-top') || document.querySelector('header');
  if (!scrollToTopBtn || !targetElement) return;
  window.addEventListener('scroll', () => {
    scrollToTopBtn.classList.toggle('visible', window.scrollY > 400);
  }, { passive: true });
  scrollToTopBtn.addEventListener('click', () => {
    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
}

// --- BAGIAN 2: EKSEKUSI & EVENT LISTENERS ---

// Event Listeners yang bisa berjalan kapan saja
// --- BAGIAN 2: EKSEKUSI & EVENT LISTENERS ---


// ==========================================================
// === TAMBAHAN BARU: FUNGSI ENTER DAN SCROLL ===
// ==========================================================
searchInput.addEventListener("keydown", function(event) {
  // Cek apakah tombol yang ditekan adalah "Enter"
  if (event.key === "Enter") {
    // 1. Mencegah aksi default dari Enter (misal: submit form)
    event.preventDefault(); 
    
    // 2. Langsung trigger filter (menghapus delay dari searchTimer)
    clearTimeout(searchTimer); // Hentikan timer yang mungkin berjalan
    filterAndDisplay(this.value.toLowerCase().trim(), selectedGenre);

    // 3. Cari elemen target untuk di-scroll
    const targetElement = document.querySelector("section.nama h2");

    // 4. Lakukan scroll jika target ditemukan
    if (targetElement) {
      targetElement.scrollIntoView({
        behavior: "smooth", // Animasi scroll halus
        block: "start"      // Berhenti di bagian atas elemen target
      });
    }
  }
});

// Event Listener baru untuk Tombol Genre dan Popup
const genrePopupBtn = document.getElementById('genre-popup-btn');
const genrePopupContainer = document.getElementById('genre-popup-container');

genrePopupBtn.addEventListener('click', (e) => {
  e.preventDefault();
  genrePopupContainer.classList.add('visible');
});

// Klik di luar popup (pada overlay) untuk menutup
genrePopupContainer.addEventListener('click', (e) => {
  if (e.target.id === 'genre-popup-container') {
    genrePopupContainer.classList.remove('visible');
  }
});

// Kode yang dijalankan setelah halaman siap (DOM Loaded)
document.addEventListener("DOMContentLoaded", async () => {
  console.log("🚀 DOM loaded. Initializing...");
  const hideSplash = initSplashScreen();
  try {
    allAnimeData = await loadAnimeData();
    const restoredScrollY = restoreState();
    if (allAnimeData.length > 0) {
      renderGenreFilters();
      filterAndDisplay(searchInput.value, selectedGenre);
      if (restoredScrollY > 0) {
        setTimeout(() => window.scrollTo({ top: restoredScrollY, behavior: 'auto' }), 100);
      }
      sessionStorage.removeItem('pageState');
    } else {
      animeListContainer.innerHTML = '<p style="text-align: center; color: #ccc; width: 100%; padding: 20px 0;">Gagal memuat anime atau tidak ada data tersedia.</p>';
    }
  } catch (error) {
    console.error("❌ Error kritis saat inisialisasi:", error);
  } finally {
    setTimeout(hideSplash, 500);
    initShrinkingHeader();
    initScrollToTopButton();
    console.log("🏁 Initialization complete.");
  }
});

// Pendaftaran Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js')
      .then(reg => console.log('✅ Service Worker registered', reg))
      .catch(err => console.error('❌ Service Worker registration failed', err));
  });
}

    </script>
  </body>
</html>